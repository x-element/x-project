<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../x-header/x-header.html">
<link rel="import" href="../x-footer/x-footer.html">
<polymer-element name="page-user-list" attributes="model">
  <template>
    <style>
      :host {
        display: block;
      }

      .page {
        margin-top: 50px;
      }
    </style>

    <core-ajax id="ajax" url="/api/Users?access_token={{ access_token }}" handleAs="json" 
      on-core-response="{{Â on_response }}"></core-ajax>

    <x-header></x-header>
    <div class="page container">
      <a is="x-link" href="/models">back</a>
      <h2>Users</h2>      
      <ul>
        <template repeat="{{ user in users }}">
          <li>
            <span>{{ user.email }}</span>
          </li>
        </template>
      </ul>
      <a is="x-link" href="/models">back</a>
    </div>
    <x-footer></x-footer>

  </template>
  <script>
    Polymer('page-user-list', {

      ready: function () {
        this.access_token = app.accessToken;
        this.$.ajax.go();
      },

      on_response: function(event, res) {
        var data = res.response;
        this.users = data;
      }

    });
  </script>
</polymer-element>