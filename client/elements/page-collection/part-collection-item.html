<link rel="import" href="../../components/core-ajax/core-ajax.html">
<polymer-element name="part-collection-item" attributes="item index schema">
	<template>
    <style>
      :host {
        display: block;
      }
    </style>

    <core-ajax id="ajax" method="DELETE" contentType="application/json" 
      url="/api/{{ schema.plural }}/{{ item.id }}"
      on-core-response="{{ on_delete_item }}" on-core-error="{{ on_error_delete_item }}"></core-ajax>

    <div>
      <ul class="list-unstyled">
        <template repeat="{{ property in schema.properties }}">
          <li>
            <strong class="key">{{ property.name }}</strong>
            <span class="value">{{ item[property.name] }}</span>
            <span class="required">{{ property.required ? 'required' : '' }}</span>
          </li>
        </template>
      </ul>
    </div>
    <div class="form-group">
      <a id="edit" class="btn btn-xs btn-warning" href="/admin/collections/{{ schema.plural }}/{{ item.id }}/edit">edit</a>
      <button id="delete" class="btn btn-xs btn-danger" on-click="{{ on_click_delete }}">delete</button>
    </div>

  </template>
  <script>
    Polymer('part-collection-item', {

      on_click_delete: function (event) {
        // var test = confirm('Are you sure?');
        // if (test === false) {
        //   return
        // }
        this.delete_item();
      },

      delete_item: function() {
        this.$.ajax.go();
      },

      on_delete_item: function () {
        console.log('delete', this.index);
        this.fire('delete', { index: this.index });
      },

      on_error_delete_item: function () {
        console.log('error deleting item', this.index);
        alert('error deleting item ' + this.index);
      }

    });
  </script>
</polymer-element>