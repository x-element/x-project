<link rel="import" href="../../components/core-ajax/core-ajax.html">
<link rel="import" href="../../components/x-link/x-link.html">
<link rel="import" href="../x-table/x-table.html">
<link rel="import" href="part-collection-item.html">
<polymer-element name="part-collection-items" attributes="items schema">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <core-ajax id="delete_item" method="DELETE" contentType="application/json" 
      url="/api/{{ schema.plural }}/{{ to_delete }}"
      on-core-response="{{ on_delete_item }}" on-core-error="{{ on_error_delete_item }}"></core-ajax>

    <x-table schema="{{ schema }}" items="{{ items }}" on-click-delete="{{ on_click_delete }}"></x-table>

  </template>
  <script>
    Polymer('part-collection-items', {

      on_click_delete: function (event, detail) {
        this.to_delete = detail.id;
        console.log(this.to_delete)
        this.$.delete_item.go();
      },

      on_delete_item: function () {
        this.fire('delete-item', this.to_delete);
      },

      on_error_delete_item: function (event) {
        console.log(event);
      }

    });
  </script>
</polymer-element>