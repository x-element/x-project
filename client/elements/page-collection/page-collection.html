<link rel="import" href="../../components/polymer/polymer.html">
<link rel="import" href="../x-header/x-header.html">
<link rel="import" href="../x-footer/x-footer.html">
<link rel="import" href="../x-schema/x-schema.html">
<link rel="import" href="part-collection-items.html">
<polymer-element name="page-collection" attributes="collection">
  <template>
    <style>      
      :host {
        display: block;
      }
    </style>

    <x-schema id="get_schema" collection="{{ collection }}"
      on-x-response="{{ on_response }}" on-x-error="{{ on_error }}"></x-schema>

    <x-header></x-header>
    <div class="page container">
      <a is="x-link" href="/admin/collections">Back to collections</a>
      <h2>{{ schema.plural }}</h2>
      <part-collection-items id="items"></part-collection-items>
    </div>
    <x-footer></x-footer>

  </template>
  <script>
    Polymer('page-collection', {

      collectionChanged: function () {
        this.$.get_schema.go();
      },

      on_response: function (event) {
        var schema = event.detail.schema;
        this.schema = schema;
        this.$.items.schema = schema;
      },

      on_error: function (event) {
        var error = event.detail.error;
        console.log(error);
      }

    });
  </script>
</polymer-element>