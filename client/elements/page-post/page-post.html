<link rel="import" href="/components/polymer/polymer.html">
<link rel="import" href="../part-header/part-header.html">
<link rel="import" href="../part-jumbotron/part-jumbotron.html">
<link rel="import" href="../part-footer/part-footer.html">
<dom-module id="page-post">
  <style>
    :host {
      display: block;
    }
  </style>
  <template>

    <iron-ajax auto id="get_post" url="{{permalink}}" handle-as="json" 
      last-response="{{post}}"></iron-ajax>

    <part-header></part-header>
    <part-jumbotron>
      <div class="container">
        <h1>{{post.title}}</h1>
        <h4><span>by </span><span>{{post.author}}</span></h4>
        <h4><span>on </span><span>{{post.posted}}</span></h4>
      </div>
    </part-jumbotron>
    <div class="page container">
      <part-post-date post="{{post}}"></part-post-date>
      <div>{{post.content}}</div>
      <a href="/posts">Back</a>
    </div>
    <part-footer></part-footer>

  </template>
</dom-module>
<script>
  Polymer({

    is: 'page-post',

    properties: {
      post_id: {
        type: String,
        observer: 'on_changed_post_id'
      },
      post: {
        type: Object,
        observer: 'on_changed_post'
      }
    },

    on_changed_post_id: function () {
      this.permalink = '/api/posts/' + this.post_id;
    },

    on_changed_post: function () {
      // this.post.posted;
    }

  });
</script>