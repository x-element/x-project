<link rel="import" href="/components/polymer/polymer.html">   
<link rel="import" href="../api-get-schema/api-get-schema.html">
<link rel="import" href="../api-post-model/api-post-model.html">
<link rel="import" href="../api-put-model/api-put-model.html">
<link rel="import" href="../app-link/app-link.html">
<link rel="import" href="../part-header/part-header.html">
<link rel="import" href="../part-footer/part-footer.html">
<link rel="import" href="part-model-edit.html">
<dom-module id="page-model-edit">
  <style>
    :host {
      display: block;
    }
  </style>
  <template>

    <api-get-schema id="get_schema" name="{{collection_name}}" 
      schema="{{schema}}"></api-get-schema>

    <api-get-model id="get_model" name="{{collection_name}}" model-id="{{model_id}}"
      model="{{model}}"></api-put-model>

    <api-post-model id="post_model" name="{{collection_name}}" model-id="{{model_id}}"
      model="{{model}}"></api-post-model>

    <api-put-model id="put_model" name="{{collection_name}}" model-id="{{model_id}}"
      model="{{model}}"></api-put-model>

    <part-header></part-header>
    <div class="page container">
      <a is="app-link" href="{{back_url}}">Back</a>
      <h1>{{collection_name}}</h1>
      <part-model-edit schema="{{schema}}" model="{{model}}"></part-model-edit>
      <button class="btn btn-success" on-click="save">save</button>
    </div>
    <part-footer></part-footer>

  </template>
</dom-module>
<script>
  Polymer({

    is: 'page-model-edit',

    properties: {
      collection_name: {
        type: String
      }
    },

    observers: [  
      'update(collection_name)'
    ],

    update: function () {
      this.back_url = '/admin/collections/' + this.collection_name;
    },

    save: function () {
      this.$.put_model.update();
    }

  });
</script>